<!DOCTYPE html>
<html>
    <head>
        <title>Tabster Test</title>
        <script type="module">
            import {
                createTabster,
                getCrossOrigin,
                getCurrentTabster,
                getDeloser,
                getGroupper,
                getModalizer,
                getMover,
                getObservedElement,
                getOutline,
            } from "../src";

            const tabsterTest = {
                getCurrentTabster,
            };

            const params = new URL(location.href).searchParams;
            const controlTab = params.get("controlTab") !== "false";
            const rootDummyInputs = params.get("rootDummyInputs") !== "false";
            const parts = (params.get("parts") || "").split(",");
            const partsToEnable = {};

            for (let part of parts) {
                partsToEnable[part] = true;
            }

            const tabster = createTabster(window, {
                autoRoot: {},
                controlTab,
                rootDummyInputs,
            });

            tabsterTest.core = tabster;

            console.log(
                "created tabster",
                `as ${
                    controlTab ? "controlled" : "uncontrolled"
                }, root dummy inputs ${rootDummyInputs}`
            );

            if ("modalizer" in partsToEnable) {
                tabsterTest.modalizer = getModalizer(tabster);
                console.log("created modalizer");
            }

            if ("deloser" in partsToEnable) {
                tabsterTest.deloser = getDeloser(tabster);
                console.log("created deloser");
            }

            if ("outline" in partsToEnable) {
                tabsterTest.outline = getOutline(tabster);
                console.log("created outline");
            }

            if ("mover" in partsToEnable) {
                tabsterTest.mover = getMover(tabster);
                console.log("created mover");
            }

            if ("groupper" in partsToEnable) {
                tabsterTest.groupper = getGroupper(tabster);
                console.log("created groupper");
            }

            if ("observed" in partsToEnable) {
                tabsterTest.observedElement = getObservedElement(tabster);
                console.log("created observed");
            }

            if ("crossOrigin" in partsToEnable) {
                tabsterTest.crossOrigin = getCrossOrigin(tabster);
                tabsterTest.crossOrigin.setup();
                console.log("created cross origin");
            }

            window.getTabsterTestVariables = () => tabsterTest;
        </script>
    </head>
    <body></body>
</html>
